<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[如何测量MTF(二)]]></title>
    <url>%2F2019%2F03%2F12%2F%E5%A6%82%E4%BD%95%E6%B5%8B%E9%87%8FMTF-%E4%BA%8C%2F</url>
    <content type="text"><![CDATA[本篇主要介绍下倾斜刃边法来测量MTF。几篇介绍倾斜刃边法的文献： M. Estribeau and P. Magnan., in SPIE Proceedings, Vol. 5251, Sept. 2003 T. Dutton et al. in SPIE Proceedings, Vol. 4486, 2002, pp. 219-246 [P.B. Burns, in Proceedings IS&amp;T, 2000, pp 135-138] [S.E. Reichenback et al. In Optical Engineering, pp. 170-177, 1991.] 倾斜刃边法是少数成为ISO图像传感器和相机测量的标准之一，编号12233。 倾斜刃边法介绍： 将一个垂直或者水平方向的边缘成像到探测器上，垂边需要与探测器的列方向稍微有所倾斜，倾斜的角度不重要， 一般建议在2°-10°之间。在这个范围内的斜边能得到最好的MTF测量结果。 探测器的每一行都能提供一个不同的边缘扩散函数(Edge Spread Function, ESF)，通过图像倾斜边缘的特定列中的像素值，可以得到空间频率响应SFR(Spatial Frequency Response)。 通过SFR，可以由微分或者差分得到线扩散函数(Line Spread Function)。 最后对LSF进行傅里叶变换，结果就是光学传递函数OTF的模，即为调制传递函数MTF。 倾斜刃边法仿真说明： 首先，合成一幅倾斜刃边图像，斜边倾斜角度为4°。在黑白过渡的区域选择一块200x300大小的区域。如图1所示。 然后选中特定的一列(本例中为第96列)，并记录该列中的所有像素值，已生成SFR。结果如图2所示。左侧为SFR坐标轴，右侧为LSF坐标轴。 接着SFR求导或差分得到LSF。 通过FFT，可以计算得到MTF。图3画出了FFT幅值与空间频率的关系。注意MTF被归一化，其值为零输入频率(= DC)，而空间频率归一化为传感器的空间采样频率。在这个模拟的例子中,像素间距等于6.5µm。 图3给出了理解结果与仿真结果的对比。从图中可以看出两条曲线重合的很好，说明倾斜刃边法是没有问题的。]]></content>
      <categories>
        <category>MTF测试</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[如何测量MTF(一)]]></title>
    <url>%2F2019%2F02%2F20%2F%E5%A6%82%E4%BD%95%E6%B5%8B%E9%87%8FMTF-%E4%B8%80%2F</url>
    <content type="text"><![CDATA[​ 简单来说，调制传递函数（Modulation Transfer Funciton）是表征成像器件空间分辨率的一种参数，其可以是成像传感器、镜头、透镜或者是一个完整的相机。它是光学传递函数的模，可由点扩展函数的傅里叶变换得到。 Harvest Imaging Blog 关于如何测量MTF的几篇介绍： How to Measure Modulation Transfer Function(1) How to Measure Modulation Transfer Function(2) How to Measure Modulation Transfer Function(3) How to Measure Modulation Transfer Function(4) How to Measure Modulation Transfer Function(5) How to Measure Modulation Transfer Function(6) How to Measure Modulation Transfer Function(7) How to Measure Modulation Transfer Function(8) How to Measure Modulation Transfer Function(9) Imatest 关于MTF的介绍 Sharpening 接下来主要将博客里的东西整理一下。]]></content>
      <categories>
        <category>MTF测试</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[实验用光源]]></title>
    <url>%2F2019%2F02%2F15%2F%E5%AE%9E%E9%AA%8C%E7%94%A8%E5%85%89%E6%BA%90%2F</url>
    <content type="text"><![CDATA[光电测试中使用的光源 Energetiq 公司开发的宽带白光光源，采用激光泵浦的方式维持等离子体放电发光， 避免了使用电极所带来的种种缺陷。 特点和优势: SMA 光纤耦合输出，便于使用 高效的光学收集装置 超高亮度，覆盖波段范围 UV-Vis-NIR (190nm - 2100nm) 无需复合灯源(可替代氘灯 / 钨灯 / 氙弧光灯)，简化光学系统 优异的空间稳定性，适于重复测量 优异的短时和长期功率稳定性，适于 重复测量 无电极工作，更低维护成本 技术参数: 光谱范围: 190nm -2100nm * 典型灯泡寿命 &gt; 9,000 小时 SMA 光纤耦合输出:NA 0.22 灯源尺寸 82.3 x 85.7 x 76.2 mm (3.2 x 3.4 x3.0 in) ，重量 0.7 kg (1.5 lbs) 电源尺寸 107 x 111 x 254 mm (4.2 x 4.4 x 10 in) (excl feet)，重量 1.4kg (3 lbs)]]></content>
      <categories>
        <category>常规光电测试</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[计算MTF软件说明]]></title>
    <url>%2F2019%2F02%2F14%2F%E8%AE%A1%E7%AE%97MTF%E8%BD%AF%E4%BB%B6%E8%AF%B4%E6%98%8E%2F</url>
    <content type="text"><![CDATA[介绍几款常用的计算MTF的软件 Imatest Master Imatest软件是全球使用最广泛的数字图像质量分析软件。它包括全功能的图像质量测试，支持绝大多数的标准测试卡。 找了个试用版装了一下，功能实在是太多了，价格感人... QuickMTF QuickMTF是另一款比较强大的软件，同样也是收费的。 演示视频看上去功能很强大，能够实现实时运算。 ImageJ计算MTF ImageJ是一个基于java的公共的图像处理软件，SE_MTF是ImageJ的一款插件，使用了Slanted Edge Method来计算MTF。 ### ImageJ SE_MTF使用方法 * 下载ImageJ及SE_MTF插件 * 将查件放在/plugins文件夹下 * 打开ImageJ选择图像，选择计算区域（必须是从黑到白，左边是黑色，右边是白色，否则需要旋转图像） * 打开插件SE_MTF，计算MTF SFRMAT3计算MTF SFRMAT3是一款Matlab编写的计算软件 下载地址 SFRMAT3使用方法 打开 MATLAB 进入sfrmat3路径下打开sfrmat3.m 运行sfrmat3.m，选择图像 出现&quot;Data Sampling &amp; weights&quot;窗口，一般情况下选择确定即可 鼠标滑动，选择计算的区域 得到结果并保存到.xls文件 MTFmapper MTFmapper是一款开源软件，但是具体怎么用还没搞明白。。 作者博客介绍了一些理论知识。 Mitre SFR Mitre SFR是用C写的，用终端来进行操作，具体使用方法软件内部有介绍。]]></content>
  </entry>
  <entry>
    <title><![CDATA[常规光电测试项目测试方法]]></title>
    <url>%2F2019%2F01%2F22%2F%E5%B8%B8%E8%A7%84%E5%85%89%E7%94%B5%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%B5%8B%E8%AF%95%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[本篇主要总结下项目中常规光电测试使用的方法，都是通过拍摄本底场、暗场、平场图像实现的。 本底统计、读出噪声 在慢读出和快读出的方式下拍摄本底场图像N帧，N≥100。 读出噪声 对本底场图像的每个像元将N次拍摄的像元值计算平均值及标准偏差，计算中剔除最大、最小值； 每一像元N次拍摄像元值的标准偏差是该像元的读出噪声，乘以增益即以电子数为单位的读出噪声； 计算各像元读出噪声，获得探测器各像元读出噪声分布情况，各像元读出噪声的平均值作为相机的读出噪声。 本底场统计 将N帧本底场合并，合并后本底场记做(Zero)反应固定图案噪声，可用作后续数据处理中本底场改正的图像； 选取本底场Zero_i一帧，减去平均本底场Zero，乘以增益，进行直方图统计，计算大于15e-和25e-的像元比例； 缺陷像元不参加统计。 光子转移曲线 设置一组曝光序列[k]，分别拍摄本底场图像n张，平场图像n张(n&gt;=4)； 每组图像选择平均值最接近的两帧图像； 选择用于制作光子转移曲线的图像区域[x1:x2,y1:y2]，共包括n个像元；图像区域应在探测器的一个通道之内； 计算两幅本底场图像B1和B2在选定区域[x1:x2,y1:y2]内的： 像元平均值 \[ \begin{align} \bar{B1}和\bar{B2} \end{align} \] \[ \begin{align} \bar { B } =\frac { 1 }{ n } \sum _{ x=x1 }^{ x2 }{ \sum _{ y=y1 }^{ y2 }{ B\_ ADU\left( x,y \right) } } \end{align} \] 方差图像 \[ \begin{align} \triangle B\left( { x }_{ i },{ y }_{ i } \right) =B1\left( { x }_{ i },{ y }_{ i } \right)-B2\left( { x }_{ i },{ y }_{ i } \right) \end{align} \] 及差值图像方差： \[ \begin{align} Var\left( \triangle B \right) =\frac { 1 }{ n } \sum _{ x=x1 }^{ x2 }{ \sum _{ y=y1 }^{ y2 }{ { \left( \triangle B\_ ADU\left( x,y \right) -\overline { \triangle B } \right) }^{ 2 } } } \end{align} \] 针对第k档曝光时间，计算该曝光档位下的两副牌平场图像F1k和F2k在选定统计区域[x1:x2,y1:y2]内的： 像元平均值 \[ \begin{align} { F1 }_{ k }和{ F2 }_{ k } \end{align} \] 差值图像，及差值图像像元值的方差 \[ \begin{align} \triangle { F }_{ k } 以及 Var\left( \triangle { F }_{ k } \right) \end{align} \] \[ \begin{align} \triangle { F }_{ k }\left( { x }_{ i },{ y }_{ i } \right) ={ F1 }_{ k }\left( { x }_{ i },{ y }_{ i } \right) -{ F2 }_{ k }\left( { x }_{ i },{ y }_{ i } \right) \end{align} \] 制作光子转移曲线，横坐标为像元平均值mean，纵坐标为方差： \[ \begin{align} mean=\frac { 1 }{ 2 } \left( \left( \overline { { F1 }_{ k } } +\overline { { F2 }_{ k } } \right) -\left( \overline { B1 } +\overline { B2 } \right) \right) \end{align} \] \[ \begin{align} Variance=\frac { 1 }{ 2 } \left( \left( Var\left( \triangle { F }_{ k } \right) \right) -\left( Var\left( \triangle B \right) \right) \right) \end{align} \] 对光子转移曲线在0到拐点之间的区间进行线性拟合，计算样本点偏离线性的程度即非线性度，将最接近拐点且非线性度 &lt;6% 的测量点对应的平均像元值作为探测器的满阱像元值； 非线性度 =（测量值-拟合值）/（拟合值）x 100% 拟合得到直线的斜率的倒数是相机的增益（gain, 单位 e-/ADU）； 在满阱典型值指标范围内计算光子转移曲线非线性度； 满阱电荷 = 满阱像元值 x gain; 制作各个通道的光子转移曲线，满阱典型值为各通道满阱电荷的平均值。 增益计算 根据一组本底图像和平场图像计算相机增益： 在当前的档位下拍摄m帧本底场，m帧平场(m≥3); Zero： 每帧计算平均值并标注 （zero1, zero2, zero3 ... zeroN） Flat： 每帧计算平均值并标注（flat1, flat2, flat3 ... flatN） 从各组（Zero/Flat）找到平均值最接近的两图像分别记为图像（Zero1,Zero2/Flat1,Flat2） 本底处理: 图像做差 Zerodif = Zero1 - Zero2; 求Zerodif图像的方差： Var(Zerodif) 图像做差 Flatdif = Flat1 - Flat2; 求Flatdif图像的方差： Var(Flatdif) \[Gain = \frac{[mean(Flat1)+mean(Flat2)]-[mean(Zero1)+mean(Zero2)]}{Var(Flat_{dif})-Var(Zero_{dif})}\] 光子响应非线性度 绘制输入输出曲线，横坐标为曝光量(曝光时间或脉冲个数)，纵坐标是相应拍摄的多幅平场图像(已经减掉本底)的平均值： \[ F_k = \frac{1}{m}(F1_k+F2_k+...Fm_k) \] 在满阱平均值指标范围内用最小二乘法对输入输出曲线进行直线拟合，确定参数 \(f(x) = a \times x\) 利用拟合的参数a来计算各曝光时间对应的拟合响应像元值\(F(fit)_k\) 在满阱平均值指标范围内计算响应非线性度 \[非线性度 =\frac{测量值-拟合值}{拟合值}\times 100 \% \] 绘制非线性度曲线 像元间响应不均匀性(PRNU) 计算公式 \[ \begin{align} PRNU=\frac { { FPN }_{ ADU } }{ \overline { ADU } } \ =\sqrt { 2 } \times \frac { \sqrt { \left( { \sigma }_{ F1 }^{ 2 }{ +\sigma }_{ F2 }^{ 2 } \right) -\left( { \sigma }_{ Z1 }^{ 2 }+{ \sigma }_{ Z2 }^{ 2 } \right) -\left( { \sigma }_{ Fdif }^{ 2 }-{ \sigma }_{ Zdif }^{ 2 } \right) } }{ \left( mean\_ F1+mean\_ F2 \right) -\left( mean\_ Z1+mean\_ Z2 \right) } \\ =\sqrt { 2 } \times \frac { \sqrt { { \left( { Var }_{ F1 }+{ Var }_{ F2 } \right) -\left( { Var }_{ Z1 }+{ Var }_{ Z2 } \right) -\left( { Var }_{ Fdif }-{ Var }_{ Zdif } \right) } } }{ \left( mean\_ F1+mean\_ F2 \right) -\left( mean\_ Z1+mean\_ Z2 \right) } \end{align} \]]]></content>
      <categories>
        <category>常规光电测试</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[如何测量满阱容量(三)]]></title>
    <url>%2F2019%2F01%2F21%2F%E5%A6%82%E4%BD%95%E6%B5%8B%E9%87%8F%E6%BB%A1%E9%98%B1%E5%AE%B9%E9%87%8F-%E4%B8%89%2F</url>
    <content type="text"><![CDATA[通过之前两篇文章的讨论，可以总结几点： 在ADC小于满阱容量的时候，线性测量的方法和Mean-Variance方法(注：目前项目测试中使用的是这种方法)可以得到相近的结果。 在ADC大于满阱容量的时候，线性测量法的结果要大于Mean-Variance法。 造成这种结果差异是由探测器响应不均匀性造成的。 灵敏度高的像元会先饱和； 满阱值不均匀，有些像元会在低满阱值饱和； 从测量结果不清楚像素的哪个部分导致饱和: the pinned-photodiode the floating diffusion capacitance the output swing limitation of the source-follower 源极跟随器的输出摆动限制， output limitation swing of the analog circuitry 模拟电路的输出限制摆动 所有这些限制都会相互干扰，这使得理解和解释的情况更加复杂。]]></content>
      <categories>
        <category>常规光电测试</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[如何测量满阱容量(二)]]></title>
    <url>%2F2019%2F01%2F21%2F%E5%A6%82%E4%BD%95%E6%B5%8B%E9%87%8F%E6%BB%A1%E9%98%B1%E5%AE%B9%E9%87%8F-%E4%BA%8C%2F</url>
    <content type="text"><![CDATA[在前篇的文章中，用输入输出来测量FWC。同时，当有了一组不同曝光时间的数据时，可以通过计算出噪声来确定满阱值。 根据之前的PTC介绍，当散粒噪声占主导时，可以得到公式： \(\sigma^2=k\times(S_{out}-S_{off})\) \(\sigma：噪声\) \(k: 转换系数\) \(S_{out}: 信号平均值方差\) \(S_{off}：本底值方差\) 我们不仅可以通过信号饱和来确定满阱容量，还能通过噪声峰值来计算。满阱容量就是当噪声达到最高值时的点。 传感器满阱值大于ADC 在这种情况下，大多数传感器或摄像机ADC的最大值被设置为能使ADC范围覆盖传感器线性响应的输出部分。 如图一所示，ADC中定义系统最大输出水平，其中传感器噪声方差为曝光时间的函数。 可以从图中看出，随着曝光时间增加，噪声方差单调增长，然后突然降低到0。这个拐点就代表了传感器的满阱值，此时，噪声方差峰值为194600DN。 根据公式，满阱值等于方差峰值除以K，减去本底值方差除K， 即 (194,600/k) – (7667/k) = 63,887 – 2517 = 61,370 DN。 传感器满阱值小于ADC 这种情况下满阱电荷容量需要明确是探测器饱和对应的值还是探测器线性部分对应的拐点。前者定为FWCsat，后者定为FWClin。通常情况下，FWClin定义为探测器输出和理想直线的偏差最大为3%的点，或是传感器输出线性度达到97%或更高的点。 根据该定义并将其转换为噪声方差，现在FWClin将定义在噪声方差偏离最大k×（3％）= 4.5％的点。如图二所示。 可以从图中看出，随着曝光时间增加，噪声方差单调增长，然后缓慢降低到0。这表明了ADC大于传感器的满阱值。这个拐点就代表了传感器的满阱值，此时，噪声方差峰值为41260DN。 FWCsat： (41,260/k) – (2389/k) = 27,013 DN 同样，根据探测器的非线性度曲线，可以看出其线性度偏离了4.5%的点处的DN值为39780DN，因此， FWClin： (39,780/k) – (2389/k) = 25,044 DN 参考资料： https://harvestimaging.com/blog/?p=1249]]></content>
      <categories>
        <category>常规光电测试</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[关于博客内容的一些说明]]></title>
    <url>%2F2019%2F01%2F19%2F%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2%E5%86%85%E5%AE%B9%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%B4%E6%98%8E%2F</url>
    <content type="text"><![CDATA[​ 之前接到任务在做如何测试MTF相关的调研的时候，发现了个博客Harvest Imaging Blog，里面有一些关于测试MTF的介绍。同时还发现了一些与项目里进行的常规光电测试有关的内容介绍，大部分都是基础知识，感觉对学习还是挺有帮助的。因此打算花一些时间翻译一下这些内容放在自己的博客里，就当记笔记了。 ​ 介于本人的水平有限，翻译还是有一定难度的，所以不一定会对应原文完完整整的翻译出来，加一些个人的理解在里边。当然直接读原文是更好的，也更好理解，所以每篇博客最后都会加上参考链接。 ​ 其他的有关光电测试的知识，偶尔应该也会总结记录下来。 ​ 这是第一次开博，希望自己能坚持下来吧。]]></content>
      <categories>
        <category>常规光电测试</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[如何测量满阱容量(一)]]></title>
    <url>%2F2019%2F01%2F15%2F%E5%A6%82%E4%BD%95%E6%B5%8B%E9%87%8F%E6%BB%A1%E9%98%B1%E5%AE%B9%E9%87%8F-%E4%B8%80%2F</url>
    <content type="text"><![CDATA[​ 今天我们来讨论下如何测量探测器的满阱容量。在测量之前，需要先明确满阱容量(Full well capacity, FWC)是什么。我们列出了两种不同的情况，第一种情况是ADC小于探测器的饱和度，第二种情况是ADC大于探测器的饱和度。 ​ 第一种情况，探测器饱和度大于ADC最大值。在这种情况下，大多数工程师会设计让ADC的最大值覆盖整个探测器的线性输出部分。如图一所示。 ​ 图中所示的就是，在恒定光照下，探测器输出响应值随着曝光时间增加而增加。同样，在图的右侧画出了探测器响应的非线性度曲线。可以看出探测器输出单调增加的输出值到饱和的过度非常突然。这种特征是用ADC来确定饱和值，饱和值为216 - 1 = 65535 DN。 ​ 这种情况下，满阱容量为饱和值减去本底值， 即 65535 - 2106 = 63429 DN。考虑增益为 3 DN/e-, 满阱电荷容量FWC = 19820 e-。 ​ 第二种情况，探测器饱和度小于ADC最大值。 这种情况下满阱电荷容量需要明确是探测器饱和对应的值还是探测器线性部分对应的拐点。前者定为FWCsat，后者定为FWClin。通常情况下，FWClin定义为探测器输出和理想直线的偏差最大为3%的点，或是传感器输出线性度达到97%或更高的点。如图二所示。 ​ 图的左边是探测器输出随曝光时间的变化，图的右边是其非线性度曲线。可以看出探测器输出单调增加到饱和的过度较为平缓。这种特征就不是用ADC来确定系统的饱和值了。 ​ 这种情况下，满阱容量也是饱和值减去本底值，即51880 - 1602 = 50278 DN。考虑到增益为 1.5 DN/e-，满阱电荷FWCsat = 33518 e-。但正如上所述，考虑到探测器输出响应在达到饱和的一段里并不是线性的，如图二，其满阱值为非线性度为3% 的点，即 45860 - 1602 = 44258， FWClin= 29505 e-。 ​ It should be clear that this last number is very much depending on the definition of FWClin. If the 3 % deviation is shifted to 1 %, the value for the FWClin will become smaller, or if the 3 % deviation is shifted to 5 %, the opposite becomes valid. 参考资料： https://harvestimaging.com/blog/?p=1238]]></content>
      <categories>
        <category>常规光电测试</category>
      </categories>
  </entry>
</search>
